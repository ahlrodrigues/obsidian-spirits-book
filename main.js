/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var D=Object.create;var w=Object.defineProperty;var P=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var R=(s,i)=>{for(var t in i)w(s,t,{get:i[t],enumerable:!0})},L=(s,i,t,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let o of A(i))!O.call(s,o)&&o!==t&&w(s,o,{get:()=>i[o],enumerable:!(e=P(i,o))||e.enumerable});return s};var I=(s,i,t)=>(t=s!=null?D(C(s)):{},L(i||!s||!s.__esModule?w(t,"default",{value:s,enumerable:!0}):t,s)),V=s=>L(w({},"__esModule",{value:!0}),s);var j={};R(j,{default:()=>x});module.exports=V(j);var r=require("obsidian");var l=require("obsidian"),B=I(require("fs/promises")),d=I(require("path")),u="spiritsbook-view",c={"pt-BR":{title:"Livro dos Esp\xEDritos",question:"Pergunta",all:"\u{1F4D6} Todas",favorites:"\u2B50 Favoritas",favoritesTitle:"\u2B50 Perguntas favoritas:",previous:"\u2B05\uFE0F Anterior",next:"Pr\xF3xima \u27A1\uFE0F",favorite:"\u2B50 Favoritar",unfavorite:"\u274C Desfavoritar",random:"\u{1F3B2} Aleat\xF3ria",removedFromFavorites:"\u274C Removido dos favoritos",addedToFavorites:"\u2B50 Adicionado aos favoritos",randomShown:"\u{1F3B2} Pergunta aleat\xF3ria exibida",errorLoading:"Erro ao carregar o conte\xFAdo do livro.",noFavorites:"Nenhuma pergunta favorita ainda."},en:{title:"The Spirits' Book",question:"Question",all:"\u{1F4D6} All",favorites:"\u2B50 Favorites",favoritesTitle:"\u2B50 Favorite Questions:",previous:"\u2B05\uFE0F Previous",next:"Next \u27A1\uFE0F",favorite:"\u2B50 Favorite",unfavorite:"\u274C Unfavorite",random:"\u{1F3B2} Random",removedFromFavorites:"\u274C Removed from favorites",addedToFavorites:"\u2B50 Added to favorites",randomShown:"\u{1F3B2} Random question shown",errorLoading:"Failed to load book content.",noFavorites:"No favorite questions yet."},es:{title:"El Libro de los Esp\xEDritus",question:"Pregunta",all:"\u{1F4D6} Todas",favorites:"\u2B50 Favoritas",favoritesTitle:"\u2B50 Preguntas favoritas:",previous:"\u2B05\uFE0F Anterior",next:"Siguiente \u27A1\uFE0F",favorite:"\u2B50 Favorita",unfavorite:"\u274C Quitar favorita",random:"\u{1F3B2} Aleatoria",removedFromFavorites:"\u274C Eliminado de favoritos",addedToFavorites:"\u2B50 A\xF1adido a favoritos",randomShown:"\u{1F3B2} Pregunta aleatoria mostrada",errorLoading:"Error al cargar el contenido del libro.",noFavorites:"A\xFAn no hay preguntas favoritas."},fr:{title:"Le Livre des Esprits",question:"Question",all:"\u{1F4D6} Toutes",favorites:"\u2B50 Favoris",favoritesTitle:"\u2B50 Questions favorites\xA0:",previous:"\u2B05\uFE0F Pr\xE9c\xE9dente",next:"Suivante \u27A1\uFE0F",favorite:"\u2B50 Favori",unfavorite:"\u274C Retirer des favoris",random:"\u{1F3B2} Al\xE9atoire",removedFromFavorites:"\u274C Supprim\xE9 des favoris",addedToFavorites:"\u2B50 Ajout\xE9 aux favoris",randomShown:"\u{1F3B2} Question al\xE9atoire affich\xE9e",errorLoading:"\xC9chec du chargement du contenu du livre.",noFavorites:"Aucune question favorite pour le moment."}},k=class extends l.ItemView{constructor(t,e){super(t);this.questions=[];this.currentIndex=0;this.favorites=new Set;this.favBtnEl=null;this.plugin=e}getViewType(){return u}getDisplayText(){let t=this.plugin.settings.language||"en";return c[t].title}getIcon(){return"book"}async onOpen(){this.injectStyles(),this.container=this.containerEl.children[1],this.container.empty(),await this.loadQuestions(),this.renderUI()}async loadQuestions(){let t=this.plugin.settings.language||"en";try{let e=this.plugin.app.vault.adapter;if(!(e instanceof l.FileSystemAdapter)){new l.Notice("Incompatible storage adapter.");return}let o=e.getBasePath(),n;try{let p=await B.readFile(d.join(o,".obsidian/plugins/obsisdian-spirits-book/path.json"),"utf-8"),a=JSON.parse(p);n=d.isAbsolute(a.path)?a.path:d.join(o,a.path)}catch(p){n=d.join(o,".obsidian/plugins/obsisdian-spirits-book/data")}let g=d.join(n,`livro_${t}.json`),h=await B.readFile(g,"utf-8");this.questions=JSON.parse(h)}catch(e){new l.Notice(c[t].errorLoading)}}renderUI(){if(!this.questions.length)return;let t=this.plugin.settings.language||"en",e=c[t];this.plugin.settings.tab="all",this.container.empty();let o=this.container.createDiv("spiritsbook-wrapper"),n=o.createEl("h1",{text:"\u{1F4D8} "+this.getDisplayText()});n.style.textAlign="center";let g=o.createDiv("spiritsbook-tabs");if(this.plugin.settings.tab!=="favorites"){let b=g.createEl("button",{text:e.favorites});b.onclick=()=>this.renderFavorites()}let h=o.createDiv("spiritsbook-display"),p=o.createDiv("spiritsbook-nav"),a=p.createEl("button",{text:e.previous}),y=p.createEl("button",{text:e.next});a.onclick=()=>this.showQuestion(this.currentIndex-1),y.onclick=()=>this.showQuestion(this.currentIndex+1);let v=o.createDiv("spiritsbook-fav-container");this.favBtnEl=v.createEl("button"),this.updateFavoriteButton(),this.favBtnEl.onclick=()=>{this.toggleFavorite(),this.updateFavoriteButton()};let E=v.createEl("button",{text:e.random});E.onclick=()=>this.showRandom();let f=o.createDiv("spiritsbook-footer");f.style.textAlign="center";let m=f.createEl("select");this.questions.forEach((b,q)=>{var T;m.add(new Option(`#${b.numero} - ${((T=b.pergunta)==null?void 0:T.substring(0,50))||"..."}`,q.toString()))}),m.onchange=()=>this.showQuestion(parseInt(m.value)),this.showQuestion(this.currentIndex)}updateFavoriteButton(){if(!this.favBtnEl)return;let t=this.plugin.settings.language||"en",e=c[t],o=this.questions[this.currentIndex];this.favBtnEl.setText(this.favorites.has(o.numero)?e.unfavorite:e.favorite)}renderFavorites(){let t=this.plugin.settings.language||"en",e=c[t];this.plugin.settings.tab="favorites",this.container.empty();let o=this.container.createDiv("spiritsbook-wrapper"),n=o.createEl("h1",{text:e.favoritesTitle});n.style.textAlign="center";let g=o.createDiv("spiritsbook-tabs");if(this.plugin.settings.tab!=="all"){let a=g.createEl("button",{text:e.all});a.onclick=()=>this.renderUI()}let h=this.questions.filter(a=>this.favorites.has(a.numero));if(!h.length){o.createEl("p",{text:e.noFavorites});return}let p=o.createEl("ul",{cls:"favorites-list"});h.forEach(a=>{var v;let y=p.createEl("li");y.createEl("a",{text:`#${a.numero} - ${((v=a.pergunta)==null?void 0:v.substring(0,50))||"..."}`,href:"#"}).onclick=E=>{E.preventDefault();let f=this.questions.findIndex(m=>m.numero===a.numero);this.renderUI(),setTimeout(()=>this.showQuestion(f),10)}})}showQuestion(t){if(t<0||t>=this.questions.length)return;this.currentIndex=t;let e=this.questions[t],o=this.container.querySelector(".spiritsbook-display");if(!o)return;o.empty();let n=o.createDiv({cls:"spiritsbook-question"});n.createEl("h2",{text:`${this.translate("question",this.plugin.settings.language)} ${e.numero}`,attr:{style:"text-align: center;"}}),n.createEl("p",{text:e.pergunta}),o.createEl("blockquote",{text:e.resposta}).addClass("spiritsbook-answer"),this.updateFavoriteButton()}toggleFavorite(){let t=this.plugin.settings.language||"en",e=c[t],o=this.questions[this.currentIndex];this.favorites.has(o.numero)?(this.favorites.delete(o.numero),new l.Notice(`${e.removedFromFavorites}: #${o.numero}`)):(this.favorites.add(o.numero),new l.Notice(`${e.addedToFavorites}: #${o.numero}`))}showRandom(){let t=this.plugin.settings.language||"en",e=c[t],o=Math.floor(Math.random()*this.questions.length);this.showQuestion(o),new l.Notice(e.randomShown)}async onClose(){console.log("[SpiritsBook] View closed")}translate(t,e="en"){var o;return((o=c[e])==null?void 0:o[t])||t}injectStyles(){let t="spiritsbook-inline-style";if(document.getElementById(t))return;let e=document.createElement("style");e.id=t,e.textContent=`
      .spiritsbook-wrapper {
        padding: 1em 0.5em;
      }
      .spiritsbook-answer {
        background-color: var(--background-primary-alt);
        color: var(--text-normal);
        padding: 1em;
        border-radius: 8px;
        margin-top: 1em;
        font-style: italic;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        width: 100%;
        box-sizing: border-box;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
      }
      .spiritsbook-question {
        margin-bottom: 1em;
      }
      .spiritsbook-nav,
      .spiritsbook-fav-container,
      .spiritsbook-tabs {
        text-align: center;
        margin-top: 1em;
      }
      .spiritsbook-tabs button:not(:last-child),
      .spiritsbook-nav button:not(:last-child),
      .spiritsbook-fav-container button:not(:last-child) {
        margin-right: 0.5em;
      }
      .spiritsbook-footer {
        margin-top: 2em;
        text-align: center;
      }
    `,document.head.appendChild(e)}};var Q={mySetting:"default",language:"en"},x=class extends r.Plugin{async onload(){console.log("[SpiritsBook] Plugin started"),await this.loadSettings(),console.log("[SpiritsBook] Settings loaded:",this.settings),this.injectStyles(),this.addRibbonIcon("book","Open The Spirit's Book",()=>{new r.Notice("SpiritsBook activated!"),this.activateView()}).addClass("spiritsbook-ribbon-class"),this.addStatusBarItem().setText("\u{1F4D8} SpiritsBook active"),this.addCommand({id:"open-modal-simple",name:"Open simple modal (SpiritsBook)",callback:()=>{new S(this.app,this.settings.language).open()}}),this.addCommand({id:"insert-text-editor",name:"Insert text in editor",editorCallback:e=>{e.replaceSelection("Text inserted by SpiritsBook")}}),this.addCommand({id:"open-modal-markdown",name:"Open modal if Markdown active",checkCallback:e=>this.app.workspace.getActiveViewOfType(r.MarkdownView)?(e||new S(this.app,this.settings.language).open(),!0):!1}),this.addSettingTab(new F(this.app,this)),this.registerView(u,e=>new k(e,this)),this.app.workspace.onLayoutReady(()=>{this.activateView()})}onunload(){console.log("[SpiritsBook] Plugin unloaded")}injectStyles(){let i=document.createElement("style");i.textContent=`
			.spiritsbook-container {
				font-size: 16px;
				font-family: 'Segoe UI', sans-serif;
				background-color: var(--background-primary);
				color: var(--text-normal);
				padding: 20px;
				border-radius: 8px;
				max-width: 600px;
				margin: auto;
			}
			.spiritsbook-question {
				font-weight: bold;
				margin-bottom: 10px;
				font-size: 1.1em;
			}
			.spiritsbook-answer {
				background-color: var(--background-secondary);
				padding: 15px;
				border-radius: 6px;
				margin-top: 10px;
				white-space: pre-wrap;
				font-size: 15px;
				line-height: 1.5;
			}
			.spiritsbook-buttons {
				display: flex;
				justify-content: flex-end;
				margin-top: 20px;
			}
			.spiritsbook-button {
				background-color: var(--interactive-accent);
				color: white;
				border: none;
				padding: 8px 16px;
				border-radius: 6px;
				cursor: pointer;
				font-size: 14px;
			}
			.spiritsbook-button:hover {
				background-color: var(--interactive-accent-hover);
			}
		`,document.head.appendChild(i)}async activateView(){console.log("[SpiritsBook] Attempting to open sidebar view...");let i=this.app.workspace.getLeavesOfType(u)[0];if(i)console.log("[SpiritsBook] View already exists, revealing..."),await this.app.workspace.revealLeaf(i);else{let t=this.app.workspace.getRightLeaf(!1);t?(await t.setViewState({type:u,active:!0}),console.log("[SpiritsBook] View created on the right sidebar.")):console.warn("[SpiritsBook] Could not obtain a right-side leaf.")}}async loadSettings(){let i=await this.loadData();this.settings=Object.assign({},Q,i)}async saveSettings(){console.log("[SpiritsBook] Saving settings:",this.settings),await this.saveData(this.settings)}},S=class extends r.Modal{constructor(i,t){super(i),this.language=t}onOpen(){let{contentEl:i}=this;i.empty();let t=i.createDiv({cls:"spiritsbook-container"});t.createEl("div",{cls:"spiritsbook-question",text:"1019. Where is the law of God written?"}),t.createEl("div",{cls:"spiritsbook-answer",text:"In the conscience."}),t.createDiv({cls:"spiritsbook-buttons"}).createEl("button",{cls:"spiritsbook-button",text:"Close"}).addEventListener("click",()=>this.close())}onClose(){this.contentEl.empty()}},F=class extends r.PluginSettingTab{constructor(i,t){super(i,t),this.plugin=t}display(){let{containerEl:i}=this;i.empty(),new r.Setting(i).setName("SpiritsBook Key").setDesc("Example configurable text").addText(t=>t.setPlaceholder("Type something...").setValue(this.plugin.settings.mySetting).onChange(async e=>{this.plugin.settings.mySetting=e,await this.plugin.saveSettings()})),new r.Setting(i).setName("Language").setDesc("Select content language").addDropdown(t=>{t.addOption("pt-BR","Portuguese").addOption("en","English").addOption("es","Spanish").addOption("fr","French").setValue(this.plugin.settings.language).onChange(async e=>{console.log("[SpiritsBook] Language changed to:",e),this.plugin.settings.language=e,await this.plugin.saveSettings();let o=this.app.workspace.getLeavesOfType(u)[0];o!=null&&(console.log("[SpiritsBook] Closing existing view to apply new language..."),await o.detach());let n=this.app.workspace.getRightLeaf(!1);n&&(console.log("[SpiritsBook] Opening new view with updated language..."),await n.setViewState({type:u,active:!0}))})})}};
